{% extends 'base.html' %}

{% block title %}
Home
{% endblock %}

{% block content %}
<div class="container">
    {% if user.is_authenticated %}

    {% for item in feed_items %}
      <div class="card mb-3 shadow-sm">
          {% if item.cover_pic %}
            <img src="{{ item.cover_pic.url }}" style="max-height: 25em; object-fit: cover;" class="card-img-top" alt="Cover image">
          {% endif %}
        <div class="card-body">

            <h5 class="card-title">{{ item.title }}</h5>
            <p class="text-muted"><i>By: {{ item.organizer.user.username }}</i></p>
            <p class="text-black">Type: {{ item.content_type }} â€¢ Posted: {{ item.created_at|date:"M d, Y H:i" }}</p>
            <p class="text-black">Description</p>
            <p class="card-text">{{ item.description|truncatechars:150 }}</p>

            <div class="d-flex">
                {% if item.content_type|lower == 'thesis' %}
                    <div class="pe-3">
                        <a href="{% url 'post:view_thesis' item.id %}" class="btn btn-primary mt-2">View {{ item.content_type }}</a>
                    </div>

                    {% if item.organizer.user == request.user %}
                        <div class="pe-3">
                            <a href="{% url 'post:edit_thesis' item.id %}" class="btn btn-primary mt-2">Edit {{ item.content_type }}</a>
                        </div>

                        <div class="pe-3">
                            <a href="{% url 'post:delete_thesis' item.id %}" class="btn btn-primary mt-2">Delete {{ item.content_type }}</a>
                        </div>
                    {% endif %}
                {% elif item.content_type|lower == 'project' %}

                    <div class="pe-3">
                        <a href="{% url 'post:view_project' item.id %}" class="btn btn-primary mt-2">View {{ item.content_type }}</a>
                    </div>
                    {% if item.organizer.user == request.user %}

                        <div class="pe-3">
                            <a href="{% url 'post:edit_project' item.id %}" class="btn btn-primary mt-2">Edit {{ item.content_type }}</a>
                        </div>

                        <div class="pe-3">
                            <a href="{% url 'post:delete_project' item.id %}" class="btn btn-primary mt-2">Delete {{ item.content_type }}</a>
                        </div>
                    {% endif %}
                {% elif item.content_type|lower == 'event' %}

                    <div class="pe-3">
                        <a href="{% url 'post:view_event' item.id %}" class="btn btn-primary mt-2">View {{ item.content_type }}</a>
                    </div>
                    {% if item.organizer.user == request.user %}

                        <div class="pe-3">
                            <a href="{% url 'post:edit_event' item.id %}" class="btn btn-primary mt-2">Edit {{ item.content_type }}</a>
                        </div>

                        <div class="pe-3">
                            <a href="{% url 'post:delete_event' item.id %}" class="btn btn-primary mt-2">Delete {{ item.content_type }}</a>
                        </div>
                    {% endif %}
                {% endif %}
            </div>

        </div>
      </div>
    {% empty %}
      <p>No posts yet.</p>
    {% endfor %}

    </div>
    {% endif %}

</div>
{% endblock%}
